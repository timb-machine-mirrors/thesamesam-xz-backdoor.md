There's a lot we don't know.

## Backdoor
* The backdoor has several components:
  - Malicious version of `build-to-host.m4` in the release dist tarballs.
  - Crafted test data in `tests/`
    - tests/files/bad-3-corrupt_lzma2.xz (cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0, 74b138d2a6529f2c07729d7c77b1725a8e8b16f1)
    - tests/files/good-large_compressed.lzma (cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0, 74b138d2a6529f2c07729d7c77b1725a8e8b16f1)
  - IFUNC mechanism, which has legitimate purpose, but exploited to do runtime hooking/redirection
    of e.g. OpenSSH's authentication routines

* For compromised release tarballs (signed, not auto-generated by github from the git repository),
  a malicious version of `build-to-host.m4` is used to execute a script during the build process.

* The script, at least in xz-5.6.0 and xz-5.6.1, checks for various conditions like the architecture
  of the machine:
  >```if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then```

* ... the toolchain being used:
  > ```
  >   if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
  >   exit 0
  >   fi
  >   if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
  >   exit 0
  >   fi
  >   LDv=$LD" -v"
  >   if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
  >   exit 0
  > ```

* ... and whether it looks like a .deb or .rpm package is being built:
  > `if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then`


## Acknowledgements

* Andres Freund who discovered the issue and reported it to *linux-distros* and then *oss-security*.
* All the hard-working security teams helping to coordinate a response and push out fixes.

## References
* https://lwn.net/Articles/967180/
* https://www.openwall.com/lists/oss-security/2024/03/29/4